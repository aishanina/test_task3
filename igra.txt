<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
</head>
<body>
<div id="desk"></div>
<div id="last_el"></div>

<script>
// глобальные переменные и выхов функции на прорисовку начальной таблицы
var color_mas = getColor();
var activate = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
var counter = 0;

CreateTable();

// функци€ getColor - формирует массив из 8 пар произвольных цветов
// дл€ дальнейшей игры
function getColor() {
  var letters = '0123456789ABCDEF';
  var color;
  var mas = [];
  
  for (var i = 0; i < 8; i++){
    color = '#';
    for (var j = 0; j < 6; j++) {
      color += letters[Math.floor(Math.random() * 16)];
    }
    mas[i] = color;
    mas[i+8] = color;
  }
  return mas.sort(function(){
  	return Math.random() - 0.5;
	});
}

// функци€ CreateTable - рисует поле 4х4 дл€ игры,
// при клике на клетку отрабатывает событие, которое вызывает функцию fillBox
function CreateTable(){
	var desk = document.getElementById('desk');
	table = document.createElement('table');
  desk.appendChild(table);
  table.border = '1';
  var idStr = 0;  

  for (var i = 0; i < 4; i++){
  	var row = table.insertRow(i);
		for(var j = 0; j < 4; j++){                   
    	var cell = row.insertCell(j);  
      
      // каждой €чейке присваиваем номер (idStr - id €чейки) и раскрашиваем
      // в белый цвет
      idStr ++;      
      cell.style.height = '20px';
      cell.style.width = '20px';      
      cell.id = idStr;
      cell.style.backgroundColor = "white";   
      cell.onclick = fillBox;
		}
	}  
}

// функци€ fillBox - провер€ем €чейку, подкрашивает или обнул€ет цвет у €чейки
function fillBox(e){ 
var newcolor = color_mas[event.target.id-1];
var k = -1;

// провер€ем парную €чейку?
for (var i = 0; i < color_mas.length; i++){
	if ((event.target.id-1) != i && newcolor == color_mas[i]) {
		k = i;    
  }
}
  // если найдена пара на эту €чейку, тогда далее ее не рассматриваем
  if (activate[event.target.id-1] > 0){
    alert ('ѕара дл€ указанной €чейки уже найдена. ƒл€ продолжени€ игры кликните на любую белую €чейку.');
  }
  // перва€ открыта€ €чейка из пары
  else if (activate[event.target.id-1] == 0 && counter == 0) {
    document.getElementById(event.target.id).style.backgroundColor = newcolor;
    counter ++;
    activate[event.target.id-1] = 1;
    document.getElementById('last_el').value = event.target.id-1;
  }
  // если нашли ранее окрашенную €чейку и ее цвет совпадает с нашим, тогда круто! продолжаем игру
  else {
     
     if (activate[k] == 1){
      document.getElementById(event.target.id).style.backgroundColor = newcolor;
      activate[event.target.id-1] = 2;
      activate[k] = 2;  
      counter = 0;  
     }
     else {
      document.getElementById(event.target.id).style.backgroundColor = "white";
      k = document.getElementById('last_el').value;
      document.getElementById(k+1).style.backgroundColor = "white";
      activate[event.target.id-1] = 0;
      activate[k+1] = 0; 
      counter = 0;
     }

  }  
} 

</script>
</body> 
</html>